<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUT CTF 2026 - Operation: Red Sky</title>
    <!-- Tailwind CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á UI -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Library jsOTP ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ (TOTP) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsotp/2.0.0/jsotp.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap');
        
        body {
            background-color: #020202;
            color: #00ff41;
            font-family: 'Fira Code', monospace;
            background-image: linear-gradient(rgba(0, 255, 65, 0.05) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(0, 255, 65, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
            overflow: hidden; /* Prevent body scroll, handle in main */
        }

        .terminal-box {
            border: 1px solid #004411;
            background: rgba(0, 5, 0, 0.9);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
        }

        .lock-card {
            transition: all 0.4s ease;
            border: 1px solid #1a1a1a;
        }

        .locked {
            filter: grayscale(1) blur(1px);
            opacity: 0.2;
            pointer-events: none;
        }

        .unlocked {
            border-color: #00ff41 !important;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
            opacity: 1 !important;
        }

        .blink { animation: blink 1.5s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.2; } }

        #otp-timer-bar {
            height: 2px;
            background: #00ff41;
            transition: width 1s linear;
        }

        .btn-military {
            background: #002200;
            border: 1px solid #00ff41;
            color: #00ff41;
            transition: all 0.2s;
        }
        .btn-military:hover:not(:disabled) {
            background: #00ff41;
            color: #000;
            box-shadow: 0 0 15px #00ff41;
        }

        /* Sidebar Bomb Animation Styles */
        .sidebar-container {
            border-right: 1px solid #331111;
            background: rgba(10, 0, 0, 0.95);
            position: relative;
            overflow: hidden;
        }
        
        .bomb-track {
            /* flex-1 handles size, relative handles children */
        }

        #bomb-element {
            transition: top 1s linear;
            z-index: 10;
            filter: drop-shadow(0 0 10px red);
        }

        #target-building {
            position: absolute;
            bottom: 20px;
            text-align: center;
            z-index: 5;
        }

        /* Custom scrollbar for main content */
        main::-webkit-scrollbar {
            width: 8px;
        }
        main::-webkit-scrollbar-track {
            background: #000;
        }
        main::-webkit-scrollbar-thumb {
            background: #003300; 
            border-radius: 4px;
        }
        main::-webkit-scrollbar-thumb:hover {
            background: #00ff41; 
        }
        /* Fire/Explosion Effect */
        @keyframes shake-hard {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-3px, -2px) rotate(-2deg); }
            20% { transform: translate(-3px, 0px) rotate(2deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(2deg); }
            50% { transform: translate(-3px, 2px) rotate(-2deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-2deg); }
            80% { transform: translate(-1px, -1px) rotate(2deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-2deg); }
        }
        @keyframes expand-blast {
            0% { transform: scale(0); opacity: 1; }
            50% { transform: scale(1.5); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        .ember-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden;
            z-index: 0;
            background: black;
        }
        
        .ember {
            position: absolute;
            bottom: -50px;
            width: 10px;
            height: 10px;
            background: orangered;
            box-shadow: 0 0 20px orangered, 0 0 40px red;
            border-radius: 50%;
            animation: rise linear infinite;
        }
        
        @keyframes rise {
            0% { bottom: -50px; opacity: 1; transform: translateX(0) scale(1); }
            50% { opacity: 0.8; transform: translateX(20px) scale(1.5); }
            100% { bottom: 120%; opacity: 0; transform: translateX(-20px) scale(0.5); }
        }
    </style>
</head>
<body class="flex h-screen w-full">

    <!-- LEFT SIDEBAR: BOMB COUNTDOWN -->
    <aside class="w-1/4 min-w-[250px] sidebar-container flex flex-col items-center py-6 shadow-[10px_0_30px_rgba(255,0,0,0.1)] z-20">
        <div class="z-20 w-full px-4 text-center mb-8">
            <h2 class="text-red-600 font-bold tracking-widest uppercase text-sm mb-2 border-b border-red-900 pb-2">Detonation Timer</h2>
            <div id="sidebar-timer" class="text-4xl font-mono text-red-500 font-bold bg-black/50 border border-red-900 rounded p-2 shadow-[0_0_15px_rgba(255,0,0,0.3)]">02:00:00</div>
        </div>

        <!-- BOMB TRACK: Fuse Burning Style -->
        <div class="bomb-track w-full flex-1 relative bg-black/20 my-4 border-y border-red-900/20">
            <!-- Fuse Rope -->
            <div class="absolute top-0 bottom-[130px] left-1/2 -translate-x-1/2 w-[6px] opacity-90 border-x border-black/30" 
                 style="background: repeating-linear-gradient(45deg, #654321, #654321 2px, #d2b48c 2px, #d2b48c 4px);"></div>

            <!-- The Spark (Moves down) -->
            <div id="fuse-spark" class="absolute left-1/2 -translate-x-1/2 z-20 transform -translate-y-1/2" style="top: 0;">
                <div class="relative">
                    <div class="absolute -top-3 -left-3 text-xl animate-spin text-orange-500">‚ú¥Ô∏è</div>
                    <div class="absolute -top-1 -left-1 w-2 h-2 bg-yellow-200 rounded-full shadow-[0_0_10px_yellow,0_0_20px_orange]"></div>
                    <div class="absolute top-0 left-0 w-1 h-2 bg-transparent shadow-[0_10px_20px_rgba(255,69,0,0.8)]"></div>
                </div>
            </div>

            <!-- The Bomb (Stationary near bottom) -->
            <div id="bomb-element" class="absolute bottom-[90px] left-1/2 -translate-x-1/2 text-5xl z-10 filter drop-shadow-[0_0_10px_rgba(255,0,0,0.5)]">
                üí£
            </div>

            <!-- The Target -->
            <div id="target-building" class="absolute bottom-5 left-1/2 -translate-x-1/2 w-full flex flex-col items-center">
                <div class="text-5xl animate-pulse grayscale opacity-70">üè¢</div>
                <div class="text-[10px] text-red-500 font-bold mt-1 uppercase tracking-wider bg-black/90 px-2 rounded border border-red-900/50">‡∏´‡∏≠‡πÅ‡∏´‡πâ‡∏ß ‡∏°‡∏ó‡∏™.</div>
            </div>
        </div>
        
        <div class="z-20 mt-auto text-[10px] text-red-800 text-center px-4 pt-4">
            <p>WARNING: BLAST RADIUS 5KM</p>
            <p class="mt-1">EVACUATE IMMEDIATELY</p>
        </div>
    </aside>

    <!-- MAIN CONTENT AREA -->
    <main class="flex-1 h-full overflow-y-auto p-4 md:p-10 flex flex-col items-center bg-black/50 relative">
        
        <!-- Header -->
        <header class="w-full max-w-5xl flex flex-col md:flex-row justify-between items-center mb-12 border-b border-green-900 pb-6 shrink-0">
            <div>
                <h1 class="text-3xl font-bold tracking-tighter text-white">SUT.BOMB.<span class="text-red-600">PROTOCOL</span></h1>
                <p class="text-[10px] text-green-800 uppercase italic">Counter-Terrorism Unit | Assignment 02-2568</p>
            </div>
            <!-- Old timer removed/hidden as requested, moved to sidebar. Can keep a small sync status here. -->
            <div class="mt-4 md:mt-0 text-center opacity-50">
                <p class="text-[10px] text-green-500 font-bold mb-1 uppercase tracking-widest">System Status</p>
                <div class="text-xl font-bold text-green-600 font-mono">ONLINE</div>
            </div>
        </header>

        <!-- DYNAMIC CONTENT CONTAINER -->
        <div id="game-container" class="w-full max-w-5xl space-y-12 pb-20 min-h-[500px]">
            <!-- Content will be loaded here via JS -->
            <div class="text-center text-green-800 animate-pulse mt-20">
                <p>Initializing Secure Connection...</p>
                <p class="text-xs mt-2 text-red-500 font-bold">(If stuck here: Ensure you are running on a Local Server, not opening file directly)</p>
            </div>
        </div>

    </main>

    <!-- Alert Modal -->
    <div id="modal" class="hidden fixed inset-0 bg-black/95 z-[100] flex items-center justify-center p-4">
        <div class="bg-zinc-950 border border-green-500 p-8 max-w-sm w-full text-center shadow-2xl terminal-box">
            <p id="modal-msg" class="text-green-500 font-bold mb-8 leading-relaxed"></p>
            <button onclick="app.closeModal()" class="w-full py-3 bg-green-700 text-black font-bold uppercase hover:bg-green-400">Roger That</button>
        </div>
    </div>

    <script>
        /**
         * CPE CTF 2026: SUT BOMB DEFUSAL CORE LOGIC
         * ----------------------------------------
         */
        const app = {
            // ‡πÄ‡∏â‡∏•‡∏¢‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£
            config: {
                symmetricKey: "SUT-BOMB-SECRET-2026",
                otpSeed: "SUTBOMBSECRET2026",
                locationCode: "F109" // ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ (F10) ‡∏ä‡∏±‡πâ‡∏ô 9
            },

            initialTime: 2 * 60 * 60,
            timeLeft: 2 * 60 * 60,
            timerInterval: null,
            otpInterval: null,

            // ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
            init: function() {
                this.startTimer();
                this.loadPhase('phases/phase1.html');
            },

            // Load HTML Phase dynamically
            loadPhase: function(path, callback) {
                const container = document.getElementById('game-container');
                fetch(path)
                    .then(response => {
                        if (!response.ok) throw new Error("Network response was not ok");
                        return response.text();
                    })
                    .then(html => {
                        container.innerHTML = html;
                        if(callback) callback();
                        // Re-bind or check for elements that need immediate attention
                        this.checkPhaseSpecifics(path);
                    })
                    .catch(err => {
                        console.error('Failed to load phase:', err);
                        container.innerHTML = `<div class="text-red-500 text-center p-10 border border-red-900 bg-red-950/20">
                            <h2 class="text-xl font-bold mb-2">ERROR LOADING MODULE</h2>
                            <p>${err.message}</p>
                            <p class="text-sm mt-4 text-zinc-400">NOTE: browser restrictions prevent fetching files via "file://" protocol.<br>Please use a local web server (e.g., Live Server in VS Code, or "python -m http.server").</p>
                        </div>`;
                    });
            },

            checkPhaseSpecifics: function(path) {
                if(path.includes('phase2')) {
                    // Phase 2 logic checks?
                } else if (path.includes('phase3')) {
                    this.setupAuthorizationObserver();
                }
            },

            // 1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á & ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î
            startTimer: function() {
                const display = document.getElementById('sidebar-timer');
                const spark = document.getElementById('fuse-spark');
                
                this.timerInterval = setInterval(() => {
                    if(this.timeLeft <= 0) {
                        clearInterval(this.timerInterval);
                        this.triggerExplosion();
                        return;
                    }
                    this.timeLeft--;
                    
                    // Time Calculation
                    const h = Math.floor(this.timeLeft / 3600).toString().padStart(2, '0');
                    const m = Math.floor((this.timeLeft % 3600) / 60).toString().padStart(2, '0');
                    const s = (this.timeLeft % 60).toString().padStart(2, '0');
                    display.innerText = `${h}:${m}:${s}`;

                    // Fuse Animation Logic
                    const totalDuration = this.initialTime;
                    const elapsed = totalDuration - this.timeLeft;
                    const percentage = (elapsed / totalDuration); // 0.0 to 1.0
                    
                    const maxTravel = 78; 
                    const currentTop = percentage * maxTravel;
                    
                    if(spark) spark.style.top = `${currentTop}%`;

                }, 1000);
            },

            // Trigger Explosion Effect
            triggerExplosion: function() {
                // Generate Embers
                let embers = '';
                for(let i=0; i<80; i++) {
                    const left = Math.random() * 100;
                    const duration = 2 + Math.random() * 4;
                    const delay = Math.random() * 5;
                    const size = 5 + Math.random() * 15;
                    embers += `<div class="ember" style="left:${left}%; width:${size}px; height:${size}px; animation-duration:${duration}s; animation-delay:${delay}s"></div>`;
                }

                document.body.innerHTML = `
                    <div class="fixed inset-0 bg-black flex flex-col items-center justify-center z-50 overflow-hidden text-center select-none cursor-default">
                        <div class="ember-container">${embers}</div>
                        
                        <!-- Explosion Scene -->
                        <div class="relative z-10 flex flex-col items-center justify-center h-full pb-20">
                            <div class="relative w-64 h-64 flex items-center justify-center mb-8">
                                <!-- The Building -->
                                <div id="doom-building" class="text-[150px] transition-all duration-1000" style="animation: shake-hard 0.2s infinite;">üè¢</div>
                                
                                <!-- The Blast (Initially Hidden) -->
                                <div id="doom-blast" class="absolute inset-0 flex items-center justify-center text-[200px] opacity-0 pointer-events-none">üí•</div>
                            </div>

                            <div id="doom-text" class="opacity-0 transition-opacity duration-1000">
                                <h1 class="text-6xl text-red-600 font-bold mb-2 tracking-tighter uppercase">Building Destroyed</h1>
                                <p class="text-2xl text-orange-400 font-mono">"‡∏´‡∏≠‡πÅ‡∏´‡πâ‡∏ß... ‡∏£‡∏≤‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏≠‡∏á..."</p>
                                <button onclick="location.reload()" class="mt-8 px-8 py-3 bg-red-900/20 border border-red-600 text-red-500 hover:bg-red-600 hover:text-white transition-all uppercase tracking-widest text-sm">
                                    Retry Mission
                                </button>
                            </div>
                        </div>
                    </div>
                `;

                // Sequencing the Animation
                setTimeout(() => {
                    const building = document.getElementById('doom-building');
                    const blast = document.getElementById('doom-blast');
                    
                    if(!building || !blast) return;

                    // 1. Explosion appears
                    blast.style.animation = "expand-blast 0.8s forwards";
                    blast.style.opacity = "1";
                    
                    // 2. Building replaced by ruins
                    setTimeout(() => {
                        building.innerText = "üèöÔ∏è"; // Ruins emoji
                        building.style.animation = "none"; // Stop shaking
                        building.style.transform = "scale(0.8) translateY(20px)";
                        building.style.filter = "grayscale(100%) brightness(50%)";
                    }, 400);

                    // 3. Text appears
                    setTimeout(() => {
                        document.getElementById('doom-text').style.opacity = "1";
                    }, 1500);

                }, 1500); // Wait 1.5s of shaking before boom
            },

            // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Modal
            showModal: function(msg) {
                document.getElementById('modal-msg').innerText = msg;
                document.getElementById('modal').classList.remove('hidden');
            },
            closeModal: function() { document.getElementById('modal').classList.add('hidden'); },

            // ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÑ‡∏õ Phase 2
            navToPhase2: function() {
                this.loadPhase('phases/phase2.html');
            },

            // ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å Lock 1: Symmetric Key
            unlock1: function() {
                const val = document.getElementById('lock1-input').value.trim();
                if (val === this.config.symmetricKey) {
                    document.getElementById('icon1').innerText = "üîì";
                    document.getElementById('lock1-section').classList.add('border-green-500');
                    document.getElementById('otp-tool').classList.remove('hidden');
                    document.getElementById('lock2-card').classList.add('unlocked');
                    this.startOTPGeneration();
                    this.showModal("LOCK 1 OPENED: ‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏™‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏£‡∏∞‡∏ö‡∏ö Token ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô!");
                } else { this.showModal("ERROR: ‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"); }
            },

            // ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏à‡∏ô OTP ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            startOTPGeneration: function() {
                if(this.otpInterval) clearInterval(this.otpInterval);
                this.otpInterval = setInterval(() => {
                    try {
                        const totp = jsOTP.totp();
                        const code = totp.getOtp(this.config.otpSeed);
                        const display = document.getElementById('live-otp');
                        const bar = document.getElementById('otp-timer-bar');
                        
                        if(display) display.innerText = code;
                        if(bar) {
                            const now = Math.floor(Date.now() / 1000);
                            const percent = ((30 - (now % 30)) / 30) * 100;
                            bar.style.width = percent + "%";
                        }
                    } catch(e) {}
                }, 1000);
            },

            // ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å Lock 2: OTP
            unlock2: function() {
                const val = document.getElementById('otp-input').value.trim();
                const totp = jsOTP.totp();
                if (val === totp.getOtp(this.config.otpSeed)) {
                    document.getElementById('icon2').innerText = "üîì";
                    document.getElementById('lock2-card').classList.add('unlocked');
                    document.getElementById('lock3-card').classList.add('unlocked');
                    document.getElementById('loc-hint').classList.remove('hidden');
                    this.showModal("LOCK 2 OPENED: ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô OTP ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î...");
                } else { this.showModal("ERROR: ‡∏£‡∏´‡∏±‡∏™ OTP ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤"); }
            },

            // ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å Lock 3: Location (SUT Building ID)
            unlock3: function() {
                const val = document.getElementById('loc-input').value.trim().toUpperCase();
                if (val === this.config.locationCode) {
                    document.getElementById('icon3').innerText = "üîì";
                    document.getElementById('lock3-card').classList.add('unlocked');
                    document.getElementById('p3-next').classList.remove('hidden');
                    this.showModal("LOCK 3 OPENED: ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏¥‡∏Å‡∏±‡∏î ‡∏°‡∏ó‡∏™. ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏î‡πà‡∏≤‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏ä‡∏ô‡∏ß‡∏ô...");
                } else { this.showModal("ERROR: ‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà ‡∏°‡∏ó‡∏™. ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"); }
            },

            // ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÑ‡∏õ Phase 3
            navToPhase3: function() {
                this.loadPhase('phases/phase3.html');
            },

            // ‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î (Authorization Logic)
            setupAuthorizationObserver: function() {
                const panel = document.getElementById('disarm-panel');
                if(!panel) return; // Wait until loaded
                
                const observer = new MutationObserver(() => {
                    if (panel.getAttribute('data-role') === "admin") {
                        this.activateAdminPrivilege();
                    }
                });
                observer.observe(panel, { attributes: true });
            },

            activateAdminPrivilege: function() {
                const roleTag = document.getElementById('role-tag');
                const disarmBtn = document.getElementById('disarm-btn');
                if(!roleTag || !disarmBtn) return;

                roleTag.innerText = "Administrator_Access";
                roleTag.classList.replace('text-red-900', 'text-green-500');
                roleTag.classList.replace('border-red-900', 'border-green-500');
                disarmBtn.disabled = false;
                disarmBtn.classList.replace('bg-zinc-900', 'bg-red-600');
                disarmBtn.classList.replace('text-zinc-700', 'text-white');
                disarmBtn.classList.replace('cursor-not-allowed', 'cursor-pointer');
                disarmBtn.onclick = () => {
                    // Hide sidebar and main content
                    document.querySelector('aside').classList.add('hidden');
                    document.querySelector('main').classList.add('hidden');
                    
                    // Load Victory
                    this.loadPhase('phases/victory.html', () => {
                         // Override the container logic since we hid main
                         // Actually, let's just replace body content for victory to ensure full screen
                         document.body.innerHTML = '';
                         fetch('phases/victory.html').then(r => r.text()).then(h => {
                             document.body.innerHTML = h;
                             document.getElementById('victory').classList.add('h-screen', 'justify-center', 'w-full', 'bg-black');
                         });
                    });

                    if(this.timerInterval) clearInterval(this.timerInterval);
                };
            }
        };

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô
        window.onload = () => app.init();
    </script>
</body>
</html>